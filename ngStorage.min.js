/*! ngstorage 0.3.7 | Copyright (c) 2015 Gias Kay Lee | MIT License */!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["angular"],b):"object"==typeof exports?module.exports=b(require("angular")):b(a.angular)}(this,function(a){"use strict";function b(b){return function(){var c="ngStorage-";this.setKeyPrefix=function(a){if("string"!=typeof a)throw new TypeError("[ngStorage] - "+b+"Provider.setKeyPrefix() expects a String.");c=a};var d=a.toJson,e=a.fromJson;this.setSerializer=function(a){if("function"!=typeof a)throw new TypeError("[ngStorage] - "+b+"Provider.setSerializer expects a function.");d=a},this.setDeserializer=function(a){if("function"!=typeof a)throw new TypeError("[ngStorage] - "+b+"Provider.setDeserializer expects a function.");e=s},this.$get=["$rootScope","$window","$log","$timeout",function(f,g,h,i){function j(a){var b;try{b=g[a]}catch(c){b=!1}if(b&&"localStorage"===a){var d="__"+Math.round(1e7*Math.random());try{localStorage.setItem(d,d),localStorage.removeItem(d)}catch(c){b=!1}}return b}var k,l,m=j(b)||(h.warn("This browser does not support Web Storage!"),{setItem:a.noop,getItem:a.noop}),n={$default:function(b){for(var c in b)a.isDefined(n[c])||(n[c]=b[c]);return n.$sync(),n},$reset:function(a){for(var b in n)"$"===b[0]||delete n[b]&&m.removeItem(c+b);return n.$default(a)},$sync:function(){for(var a,b=0,d=m.length;d>b;b++)(a=m.key(b))&&c===a.slice(0,10)&&(n[a.slice(10)]=e(m.getItem(a)))}};n.$sync(),k=a.copy(n);var o=function(a){m.setItem("ngStorageUpdated-"+a,(new Date).toString()),m.removeItem("ngStorageUpdated-"+a)};return f.$watch(function(){var b;l||(l=i(function(){if(l=null,!a.equals(n,k)){b=a.copy(k),a.forEach(n,function(e,f){a.isDefined(e)&&"$"!==f[0]&&(m.setItem(c+f,d(e)),o(f)),delete b[f]});for(var e in b)m.removeItem(c+e),o(e);k=a.copy(n)}},100,!1))}),g.addEventListener&&g.addEventListener("storage",function(b){if(!(g.document&&g.document.hasFocus&&g.document.hasFocus())&&"ngStorageUpdated-"===b.key.slice(0,17)){if(!b.newValue)return;var c=b.key.slice(17);g.setTimeout(function(){var b=m.getItem("ngStorage-"+c);b?n[c]=e(b):delete n[c],k=a.copy(n),f.$apply()})}}),n}]}}return a=a||window.angular,a.module("ngStorage",[]).provider("$localStorage",b("localStorage")).provider("$sessionStorage",b("sessionStorage"))});